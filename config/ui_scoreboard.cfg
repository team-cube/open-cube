///////////////////////////////////////////////////////////////////////////////
//  Scoreboard                                                               //
///////////////////////////////////////////////////////////////////////////////

newui "scoreboard" [
   if $mainmenu [hideui "scoreboard"]
   uiallowinput 0
   refreshscoreboard
   uicolor $c_menu_a 0 0 [
      uivlist 0 [
         UI_sbheader
         uifill 0 0.005
         if (> $getmode 2) [
            UI_sbtopteam
            uifill 0 0.005
            UI_playerlistteam
         ] [
            UI_sbtopsolo
            uifill 0 0.005
            UI_playerlistsolo
         ]
         uifill 0 0.005
         UI_spectatorlist
      ]
      uioutline $c_line_a ; uiclamp- 1 1 1 1
   ]
] [if $mainmenu [hideui "scoreboard"]] []

///////////////////////////////////////////////////////////////////////////////

UI_sbwsolo = 0.75
UI_sbwteam = 1.12
UI_sbheader = [
   uifill 0 0.005
   uifill (? (> $getmode 2) $UI_sbwteam $UI_sbwsolo) 0.05 [
      uifill (? (= $showip 1) (-f (? (> $getmode 2) $UI_sbwteam $UI_sbwsolo) 0.18) (? (> $getmode 2) $UI_sbwteam $UI_sbwsolo)) 0 [
         uialign -1
         uiclip (? (= $showip 1) (-f (? (> $getmode 2) $UI_sbwteam $UI_sbwsolo) 0.18) (? (> $getmode 2) $UI_sbwteam $UI_sbwsolo)) 0 [
            uialign -1
            uispace 0.01 0 [
               uivlist 0 [
                  if $scoreboardservinfo [
                     uitext $scoreboardservinfo 0.65
                  ] [
                     uitext "^f4Tesseract" 0.65
                  ]
                  uihlist 0.015 [
                     uifill
                     uihlist 0.003 [
                        uitext "^fs[" 0.52
                        uitext (format "%2%1" (getmastermodename $getmastermode) (at ["^f0" "^f0" "^f2" "^f3"] $getmastermode)) 0.52
                        uitext "^fS]" 0.52
                     ]
                     UItriangle 0x606060 0.01 0.01 270
                     uitext (getmodeprettyname $getmode) 0.52
                     UItriangle 0x606060 0.01 0.01 270
                     uitext $scoreboardmap 0.52
                     if (m_timed $getmode) [
                        UItriangle 0x606060 0.01 0.01 270
                        uitext (concatword (? (|| $intermission $paused) "^f3" "^f8") $scoreboardtime) 0.52
                     ]
                  ]
                  uialign* -1
               ]
            ]
         ]
      ]
      if $showip [
         uifill 0.18 0 [
            uialign 1
            UIbar 0 1; uialign- -1
            uiclip 0.18 0 [
               uialign 1
               uispace 0.01 0 [
                  uivlist 0.004 [
                     uicolortext $servinfoname 0xA0A0A0 0.52
                     uicolortext $servinfoport 0xA0A0A0 0.52
                     uialign* 1
                  ]
               ]
               uialign- 1
            ]
         ]
      ]
   ]
]
//-------------------------------------------------------------------------------------------------
UI_sbtopsolo = [
   uicolor 0x99161616 $UI_sbwsolo 0.022 [
      uihlist 0 [
         uialign 1 1
         if $showkills        [uifill 0.080 0 [uicolortext "K"    0xBBCC8B 0.45 ; uialign- 1]]
         if $showdeaths       [uifill 0.060 0 [uicolortext "D"    0xE57B50 0.45 ; uialign- 1]]
         if $scoreboardmultiplayer [
            if $showpj        [uifill 0.060 0 [uicolortext "PJ"   0x85A2CC 0.45 ; uialign- 1]]
            if $showping      [uifill 0.060 0 [uicolortext "PING" 0x85A2CC 0.45 ; uialign- 1]]
            if $showclientnum [uifill 0.046 0 [uicolortext "#"    0xA0A0A0 0.45 ; uialign- 1]]
         ]
         uifill 0.018
      ]
   ]
]
UI_sbtopteam = [
   uihlist 0 [
      uicolor 0x99202860 (*f $UI_sbwteam 0.5) 0.042 [ // <<-- AZUL
         uihlist 0 [
            uialign -1 1
            uifill 0.018
            if $scoreboardmultiplayer [
               if $showclientnum [uifill 0.046 0 [uicolortext "#"    0xA0A0A0 0.45 ; uialign- -1]]
               if $showping      [uifill 0.060 0 [uicolortext "PING" 0x85A2CC 0.45 ; uialign- -1]]
               if $showpj        [uifill 0.060 0 [uicolortext "PJ"   0x85A2CC 0.45 ; uialign- -1]]
            ]
            if $showdeaths       [uifill 0.060 0 [uicolortext "D"    0xE57B50 0.45 ; uialign- -1]]
            if $showkills        [uifill 0.080 0 [uicolortext "K"    0xBBCC8B 0.45 ; uialign- -1]]
         ]
         uispace 0.01 0 [
            uialign 1
            uicolortext (getteamscore 1) 0x4060D0 1
         ]
      ]
      uicolor 0x99602020 (*f $UI_sbwteam 0.5) 0.042 [ // -->> ROJO
         uispace 0.01 0 [
            uialign -1
            uicolortext (getteamscore 2) 0xD04040 1
         ]
         uihlist 0 [
            uialign 1 1
            if $showkills        [uifill 0.080 0 [uicolortext "K"    0xBBCC8B 0.45 ; uialign- 1]]
            if $showdeaths       [uifill 0.060 0 [uicolortext "D"    0xE57B50 0.45 ; uialign- 1]]
            if $scoreboardmultiplayer [
               if $showpj        [uifill 0.060 0 [uicolortext "PJ"   0x85A2CC 0.45 ; uialign- 1]]
               if $showping      [uifill 0.060 0 [uicolortext "PING" 0x85A2CC 0.45 ; uialign- 1]]
               if $showclientnum [uifill 0.046 0 [uicolortext "#"    0xA0A0A0 0.45 ; uialign- 1]]
            ]
            uifill 0.018
         ]
      ]
   ]
]
//-------------------------------------------------------------------------------------------------
UI_playerlistsolo = [
   uivlist 0 [
      uifill 0 0 [ // <---------- START CRAP
         uialign 0 -1
         uivlist 0 [
            uialign 0 -1
            loop a 8 [
               uicolor $blarg_solo1 $blarg_listwsolo $blarg_listrowh
               uicolor $blarg_solo2 $blarg_listwsolo $blarg_listrowh
            ]
            uialign* 0 -1
         ] // <---------- END CRAP
         uivlist 0 [
            uialign 0 -1
            loopscoreboard cn 0 [
               uicolor $blarg_solo2 $blarg_listwsolo $blarg_listrowh [
                  pushif highlight (scoreboardhighlight $cn) [
                     uifill (-f $blarg_listwsolo 0.002) (-f $blarg_listrowh 0.002) [uioutline 0xA0A0A0 ; uiclamp- 1 1 1 1] // outline fix/hack
                  ]
                  uihlist 0 [
                     uialign -1
                     uifill 0.01
                     uicolortext (getclientcolorname $cn) (scoreboardstatus $cn) 0.6
                  ]
                  uihlist 0 [
                     uialign 1
                     if $showkills        [uifill 0.080 0 [uicolortext (getclientfrags $cn) 0xBBCC8B 0.52 ; uialign- 1]]
                     if $showdeaths       [uifill 0.060 0 [uicolortext (getclientfrags $cn) 0xE57B50 0.52 ; uialign- 1]]
                     if $scoreboardmultiplayer [
                        if (isai $cn) [
                           if $showpj        [uifill 0.060 0 [uitext "^f4-" 0.52 ; uialign- 1]]
                           if $showping      [uifill 0.060 0 [uitext "^f4-" 0.52 ; uialign- 1]]
                           if $showclientnum [uifill 0.046 0 [uitext "^f4-" 0.52 ; uialign- 1]]
                        ] [
                           if $showpj        [uifill 0.060 0 [uicolortext (scoreboardpj $cn)   0x85A2CC 0.52 ; uialign- 1]]
                           if $showping      [uifill 0.060 0 [uicolortext (scoreboardping $cn) 0x85A2CC 0.52 ; uialign- 1]]
                           if $showclientnum [uifill 0.046 0 [uicolortext $cn                  0xA0A0A0 0.52 ; uialign- 1]]
                        ]
                     ]
                     uifill 0.009
                  ]
               ]
            ]
         ]
      ]
   ]
]

UI_playerlistteam = [
   uihlist 0 [
      uifill 0 0 [ // <---------- START CRAP
         uialign 0 -1
         uivlist 0 [
            uialign 0 -1
            loop a 8 [
               uicolor $blarg_azul1 $blarg_listwteam $blarg_listrowh
               uicolor $blarg_azul2 $blarg_listwteam $blarg_listrowh
            ]
            uialign* 0 -1
         ] // <---------- END CRAP
         uivlist 0 [ // <<-- AZUL
            uialign 0 -1
            uifill $blarg_listwteam 0
            loopscoreboard cn 1 [
               //uicolor $blarg_azul1 $blarg_listwteam $blarg_listrowh [
               uifill $blarg_listwteam $blarg_listrowh [
                  pushif highlight (scoreboardhighlight $cn) [
                     uifill (-f $blarg_listwteam 0.002) (-f $blarg_listrowh 0.002) [uioutline 0xA0A0A0 ; uiclamp- 1 1 1 1] // outline fix/hack
                  ]
                  uihlist 0 [
                     uialign 1
                     uicolortext (getclientcolorname $cn) (scoreboardstatus $cn) 0.6
                     uifill 0.01
                  ]
                  uihlist 0 [
                     uialign -1
                     uifill 0.009
                     if $scoreboardmultiplayer [
                        if (isai $cn) [
                           if $showclientnum [uifill 0.046 0 [uitext "^f4-" 0.52 ; uialign- -1]]
                           if $showping      [uifill 0.060 0 [uitext "^f4-" 0.52 ; uialign- -1]]
                           if $showpj        [uifill 0.060 0 [uitext "^f4-" 0.52 ; uialign- -1]]
                        ] [
                           if $showclientnum [uifill 0.046 0 [uicolortext $cn                  0xA0A0A0 0.52 ; uialign- -1]]
                           if $showping      [uifill 0.060 0 [uicolortext (scoreboardping $cn) 0x85A2CC 0.52 ; uialign- -1]]
                           if $showpj        [uifill 0.060 0 [uicolortext (scoreboardpj $cn)   0x85A2CC 0.52 ; uialign- -1]]
                        ]
                     ]
                     if $showdeaths          [uifill 0.060 0 [uicolortext (getclientfrags $cn) 0xE57B50 0.52 ; uialign- -1]]
                     if $showkills           [uifill 0.080 0 [uicolortext (getclientfrags $cn) 0xBBCC8B 0.52 ; uialign- -1]]
                  ]
               ]
            ]
         ]
      ]
      uifill 0.02 //********************************************************
      uifill 0 0 [ // <---------- START CRAP
         uialign 0 -1
         uivlist 0 [
            uialign 0 -1
            loop a 8 [
               uicolor $blarg_rojo1 $blarg_listwteam $blarg_listrowh
               uicolor $blarg_rojo2 $blarg_listwteam $blarg_listrowh
            ]
            uialign* 0 -1
         ] // <---------- END CRAP
         uivlist 0 [ // -->> ROJO
            uialign 0 -1
            uifill $blarg_listwteam 0
            loopscoreboard cn 2 [
               //uicolor $blarg_rojo1 $blarg_listwteam $blarg_listrowh [
               uifill $blarg_listwteam $blarg_listrowh [
                  pushif highlight (scoreboardhighlight $cn) [
                     uifill (-f $blarg_listwteam 0.002) (-f $blarg_listrowh 0.002) [uioutline 0xA0A0A0 ; uiclamp- 1 1 1 1] // outline fix/hack
                  ]
                  uihlist 0 [
                     uialign -1
                     uifill 0.01
                     uicolortext (getclientcolorname $cn) (scoreboardstatus $cn) 0.6
                  ]
                  uihlist 0 [
                     uialign 1
                     if $showkills           [uifill 0.080 0 [uicolortext (getclientfrags $cn) 0xBBCC8B 0.52 ; uialign- 1]]
                     if $showdeaths          [uifill 0.060 0 [uicolortext (getclientfrags $cn) 0xE57B50 0.52 ; uialign- 1]]
                     if $scoreboardmultiplayer [
                        if (isai $cn) [
                           if $showpj        [uifill 0.060 0 [uitext "^f4-" 0.52 ; uialign- 1]]
                           if $showping      [uifill 0.060 0 [uitext "^f4-" 0.52 ; uialign- 1]]
                           if $showclientnum [uifill 0.046 0 [uitext "^f4-" 0.52 ; uialign- 1]]
                        ] [
                           if $showpj        [uifill 0.060 0 [uicolortext (scoreboardpj $cn)   0x85A2CC 0.52 ; uialign- 1]]
                           if $showping      [uifill 0.060 0 [uicolortext (scoreboardping $cn) 0x85A2CC 0.52 ; uialign- 1]]
                           if $showclientnum [uifill 0.046 0 [uicolortext $cn                  0xA0A0A0 0.52 ; uialign- 1]]
                        ]
                     ]
                     uifill 0.009
                  ]
               ]
            ]
         ]
      ]
   ]
]
//-------------------------------------------------------------------------------------------------
UI_spectatorlist = [
   if $showspectators [
      uicolor 0x99161616 0 0.005 [
         uiclamp 1 1 1 1
         uigrid 2 0.04 0.02 [ // <---------- ????? Wrapping uihlist ?????
            loopscoreboard cn -1 [
               uispace 0.01 0.01 [
                  pushif sbhigh (scoreboardhighlight $cn) [
                     uioutline 0xA0A0A0 ; uiclamp- 1 1 1 1
                  ]
                  uihlist 0.01 [
                     uicolortext (getclientcolorname $cn) (scoreboardstatus $cn) 0.52
                     if $scoreboardmultiplayer [if $showclientnum [uitext $cn 0.52]]
                  ]
               ]
            ]
         ]
      ]
   ]
]

///////////////////////////////////////////////////////////CRAP
   blarg_listrowh  = 0.026
   blarg_listwsolo = (-f $UI_sbwsolo 0.02)
   blarg_listwteam = (-f (*f $UI_sbwteam 0.5) 0.02)

   blarg_rojo1 = 0x993B3535
   blarg_rojo2 = 0x99332E2E

   blarg_azul1 = 0x9935383B
   blarg_azul2 = 0x992E3033

   blarg_solo1 = 0x992F2F2F
   blarg_solo2 = 0x99292929
///////////////////////////////////////////////////////////CRAP