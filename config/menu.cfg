// standard menu definitions
// don't modify, add personal menus to autoexec.cfg instead

exec "config/menu_fkey.cfg" // F# Key Menus

togglemainmenu = [|| (hidetopui) [toggleui main]]

bind ESCAPE [togglemainmenu]

///////////////////////////////////////////////////////////////////////////////
//  Menu - Main                                                              //
///////////////////////////////////////////////////////////////////////////////
UIMenuNoTitle "main" [
   uihlist 0.0075 [
      uivlist 0.0075 [
         //UIButton "Load Map"     [hideui main; showui loadmap]
         //UICondButton "Editing"  [$editing] [ ]
         UIButton "Multiplayer"  [hideui main; showui servers]
         UIButton "Player Setup" [hideui main; showui player_setup]
         uispace 0 0.01
         UIButton "Options"      [hideui main; showui options]
         UIButton "Credits"      [hideui main; showui credits]
         uispace 0 0.01
         if (isconnected) [UIButton "Disconnect" [disconnect]] [UIButton "Quit" [quit]]
      ]
   ]
]

///////////////////////////////////////////////////////////////////////////////
//  Menu - Server Browser                                                    //
///////////////////////////////////////////////////////////////////////////////
UIMenu "servers" [
    refreshservers
    UIVScroller 1.3 0.8 0.03 0.5 [
        uitable 0.01 [
            uialign 0 -1
            uitableheader [
                uitext ping 0.7
                uitext players 0.7
                uitext mode 0.7
                uitext map 0.7
                uitext time 0.7
                uitext master 0.7
                uitext port 0.7
                uitext description 0.7
                uialign* -1 0
            ] [
                uiline 0xFFFFFF; uiclamp- 1 1; uialign- 0 1
            ]
            loop i (numservers) [
                if (servinfovalid $i) [
                    uitablerow [
                        uitext (servinfoping $i) 0.7
                        uitext (servinfoplayers $i) 0.7
                        uitext (servinfomodename $i) 0.7
                        uitext (servinfomap $i) 0.7
                        uitext (servinfotime $i) 0.7
                        uitext (servinfomastermodename $i) 0.7
                        uitext (servinfoport $i) 0.7
                        uitext (servinfodesc $i) 0.7
                        uialign* -1 0
                    ] [
                        uihold [
                            uicolor 0x404040; uiclamp -1 1 1 1
                            uioutline 0xC0C0C0; uiclamp- 1 1 1 1
                        ] [
                            uihover [
                                uicolor 0x585858; uiclamp- 1 1 1 1
                                uioutline 0xC0C0C0; uiclamp- 1 1 1 1
                            ]
                        ]
                        uirelease [connectservinfo $i]
                    ]
                ] [
                    uitablerow [] [
                        uitext (servinfodesc $i) 0.7
                    ]
                ]
            ]
        ]
    ]
] "Server Browser" [initservers]

///////////////////////////////////////////////////////////////////////////////
//  Menu - Player Setup                                                      //
///////////////////////////////////////////////////////////////////////////////
UIMenu "player_setup" [
   uifill 0.3 0.3
]

///////////////////////////////////////////////////////////////////////////////
//  Menu - Options Menu                                                      //
///////////////////////////////////////////////////////////////////////////////
UIMenu "options" [
   uifill 0.3 0.3
]

///////////////////////////////////////////////////////////////////////////////
//  Menu - Credits                                                           //
///////////////////////////////////////////////////////////////////////////////
uicredittexttile = [uitext (concatword "^f4" $arg1) 0.6]
uicredittextuser = [uitext (concatword "   ^f7" (? $arg1 [@arg1 ]) "^f2" (? $arg2 (format ["%1" ] $arg2)) "^f7" (? $arg3 [@arg3 ]) "^f4" (? $arg4 [: @arg4])) 0.6]
// uicredittextuser [First] [Alias] [Last] [Text]

UIMenu "credits" [
   UIVScroller 1.0 0.8 0.03 0.5 [
      uivlist 0.001 [
         uicredittexttile [Project]
         uiline 0xFFFFFF; uiclamp- 1 1
         uicredittextuser "Lee" "eihrul" "Salzman" "Code Gatekeeper"
         uicredittextuser "Shane" "Nieb" "Nieb" "Media Gatekeeper"
         uispace 0 0.01
         uicredittexttile "Code"
         uiline 0xFFFFFF; uiclamp- 1 1
         uicredittextuser "Lee" "eihrul" "Salzman" ""
         uicredittextuser "" "Hirato" "" ""
         uispace 0 0.01
         uicredittexttile "Art 2D/3D"
         uiline 0xFFFFFF; uiclamp- 1 1
         uicredittextuser "Shane" "Nieb" "Nieb" "Mapmodels, Textures"
         uispace 0 0.01
         uicredittexttile "Sound"
         uiline 0xFFFFFF; uiclamp- 1 1
         uicredittextuser "Shane" "Nieb" "Nieb" ""
         uicredittextuser "" "Q009" "" ""
         uispace 0 0.01
         uicredittexttile "Cartography"
         uiline 0xFFFFFF; uiclamp- 1 1
         uicredittextuser "Shane" "Nieb" "Nieb" "complex"
         uispace 0 0.01
         uicredittexttile "Kudos"
         uiline 0xFFFFFF; uiclamp- 1 1
         uicredittextuser "" "graphitemaster" "" "SVN IRC bot"
         uicredittextuser "" "RaZgRiZ" "" "UI Documentation"
         uispace 0 0.01
         uicredittexttile "Cube Engine 2"
         uiline 0xFFFFFF; uiclamp- 1 1
         uicredittextuser "Wouter" "Aardappel" "van Oortmerssen" ""
         uicredittextuser "Lee" "eihrul" "Salzman" ""
         uicredittextuser "Mike" "Gilt" "Dysart" ""
         uicredittextuser "Robert" "baby-rabbit" "Pointon" ""
         uicredittextuser "Quinton" "Quin" "Reeves" ""
         uicredittextuser "John" "geartrooper" "Siar" ""
         uicredittextuser "and others..."
         uicredittextuser "http://sauerbraten.org/"
         uispace 0 0.01
         uialign* -1 -1
      ]
      uialign* 0 -1
   ]
] "Tesseract Credits"

///////////////////////////////////////////////////////////////////////////////
//  Dialog - Display Changes                                                 //
///////////////////////////////////////////////////////////////////////////////
UIMenuNoTitle "changes" [
   uivlist 0.01 [
      uitext "The follow settings have changed:"
      uispace 0 0.01
      loop i (pendingchanges) [
         uitext (pendingchanges $i)
      ]
      uispace 0 0.01
      uitext "Apply changes now?"
      uihlist 0 [
         UIButton "Yes" [applychanges]
         uispace 0.02 0
         UIButton "No" [hideui changes]
      ]
   ]
]

///////////////////////////////////////////////////////////////////////////////
//  Scoreboard                                                               //
///////////////////////////////////////////////////////////////////////////////
scoreboardtable = [
    uitable 0.01 [
        uiclamp 1 1 0 0
        uialign 0 -1
        if (> $arg1 0) [
            uitableheader [] [
                if (= $arg1 1) [uicolor 0x3333C0] [uicolor 0xC03333]
                    uiclamp- 1 1 1 1
                uispace 0.01 0 [
                    uialign -1 0
                    uitext (getteamname $arg1) 0.9
                ]
                uispace 0.01 0 [
                    uialign 1 0
                    uitext (getteamscore $arg1) 0.9
                ]
            ]
        ]
        uitableheader [
            if (scoreboardshowfrags) [uitext frags 0.75]
            uitext name 0.75
            if (scoreboardmultiplayer) [
                if $showpj [uitext pj 0.75]
                if $showping [uitext ping 0.75]
            ]
            if (scoreboardshowclientnum) [uitext cn 0.75]
            uialign* -1 0
        ] [
            uiline 0xFFFFFF; uiclamp- 1 1; uialign- 0 1
        ]
        loopscoreboard cn $arg1 [
            uitablerow [
                if (scoreboardshowfrags) [uitext (getclientfrags $cn) 0.9]
                uicolortext (getclientcolorname $cn) (scoreboardstatus $cn)
                if (scoreboardmultiplayer) [
                    if $showpj [uitext (scoreboardpj $cn) 0.9]
                    if $showping [uitext (scoreboardping $cn) 0.9]
                ]
                if (scoreboardshowclientnum) [uitext $cn 0.9] 
                uialign* -1 0
            ] [
                pushif sbhigh (scoreboardhighlight $cn) [
                    uicolor $sbhigh; uiclamp- 1 1 1 1
                ]
            ]   
        ]
    ]
]

scoreboardspectators = [
    uifill 0 0.01
    if (scoreboardshowclientnum) [
        uitable 0.01 [
            uiclamp 1 1 1 1
            uialign 0 -1
            uitableheader [
                uitext spectator 0.75
                uitext cn 0.75
                uialign* -1 0
            ] [
                uiclamp 1 1 1 1
                uiline 0xFFFFFF; uiclamp- 1 1; uialign- 0 1
            ]
            loopscoreboard cn -1 [
                uitablerow [
                    uicolortext (getclientcolorname $cn) (scoreboardstatus $cn)
                    uitext $cn 0.9
                    uialign* -1 0
                ] [
                    pushif sbhigh (scoreboardhighlight $cn) [
                        uicolor $sbhigh; uiclamp- 1 1 1 1
                    ]
                ]
            ]
        ]
    ] [
        uigroup [
            uiclamp 1 1 1 1
            uitext spectators 0.75
            uiline 0xFFFFFF; uiclamp- 1 1; uialign- 0 1
        ]
        uigrid 3 0.01 [
            uiclamp 1 1 1 1
            loopscoreboard cn -1 [
                uicolortext (getclientcolorname $cn) (scoreboardstatus $cn) 0.75 [
                    pushif sbhigh (scoreboardhighlight $cn) [
                        uicolor $sbhigh; uiclamp- 1 1 1 1
                    ]
                ]
            ]
        ]
    ]
]

UIMenuNoTitle scoreboard [uiallowinput 0; if $mainmenu [hideui scoreboard] [
    refreshscoreboard
    uispace 0.01 0.01 [
        uivlist 0.01 [
            pushif sbserv (scoreboardservinfo) [
                uitext $sbserv 0.9
            ]
            uihlist 0.01 [
                uitext (scoreboardmode) 0.9
                uispace 0.01 0 [uiclamp 0 0 1 1; uiline 0xC0C0C0; uiclamp- 0 0 1 1]
                uitext (scoreboardmap) 0.9
                pushif sbtime (scoreboardtime) [
                    uispace 0.01 0 [uiclamp 0 0 1 1; uiline 0xC0C0C0; uiclamp- 0 0 1 1]
                    uitext $sbtime 0.9
                ]
                if (!= $gamespeed 100) [
                    uispace 0.01 0 [uiclamp 0 0 1 1; uiline 0xC0C0C0; uiclamp- 0 0 1 1]
                    uitext $prettygamespeed 0.9
                ]
                if $paused [
                    uispace 0.01 0 [uiclamp 0 0 1 1; uiline 0xC0C0C0; uiclamp- 0 0 1 1]
                    uitext paused 0.9
                ]
            ]
            if (m_teammode (getmode)) [
                uihlist 0.02 [
                    uiclamp 1 1 1 1
                    scoreboardtable 1
                    scoreboardtable 2
                ]
            ] [
                scoreboardtable 0
            ]
            if (numscoreboard -1) [
                scoreboardspectators
            ]
        ]
    ]
]]

